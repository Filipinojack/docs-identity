---
title: Adding Users to a Single Sign-On Service Plan
---

You cannot add users to Service Plans from the Single Sign-On dashboard. In order to add users to Service Plans, you must use the UAA Command Line Interface (UAAC). If you do not already have the UAAC installed, run `gem install cf-uaac` in a terminal window. 

This topic describes how to use UAAC to add users to your Service Plans.

## <a id="update-client"></a>Client Registration

1. Target your system domain.
<pre class="terminal">$ uaac target <span>https</span>://login.YOUR-SYSTEM-DOMAIN</pre>
<p class="note"><strong>Note</strong>: If you do not have SSL configured, you can turn off SSL validation with <code>--skip-ssl-validation</code></p>

1. Fetch your admin client token.
<pre class="terminal">$ uaac target client get admin
Client secret: 
</pre> 
1. When prompted with `Client secret`, enter your **Admin Client Credentials** located in the **Credentials** tab of your **Pivotal Elastic Runtime** tile.
1. Update the client registration for `identity`.
<pre class="terminal">$ uaac client update identity -i
name (string) []:
</pre>
1. When prompted with `name (string) []:`, press enter if you have no changes.
1. You must update the next two fields with the following information:
	* When prompted with `scope (list)`, copy and paste the following and press enter.
	`cloud_controller.admin cloud_controller.read cloud_controller.write openid zones.*.* zones.*.*.* zones.read zones.write clients.read clients.admin zones.uaa.admin`
	* When prompted for `authorized grant types (list)`, copy and paste the following and press enter:
	`authorization_code client_credentials password refresh_token`

1. You will then be prompted to update the several fields listed below. Press enter if you have no changes. 
	* `authorities (list)`
	* `access token validity (seconds)`
	* `refresh token validity (seconds)`
	* `redirect uri (list)`
	* `autoapprove (list)`
	* `signup redirect url (url)`


## <a id="client-creation"></a>Client Creation

1. Target your system domain.
<pre class="terminal">$ uaac target <span>https</span>://login.YOUR-SYSTEM-DOMAIN</pre>

1. Use the identity client and the administrator user credentials to retrieve a token which allows client creation in a given identity zone.
<pre class="terminal">$ uaac token owner get

1. When prompted with `Client ID`, type `identity` and press enter.
1. When prompted with `Client secret`, enter your **Identity Client Credentials** located in the **Credentials** tab of your **Pivotal Elastic Runtime** tile.
1. When prompted with `User name`, enter `Admin`.
1. When prompted with `Password`, enter your **Admin Credentials** located in the **Credentials** tab of your **Pivotal Elastic Runtime** tile.
</pre>

1. Find the Identity Zone ID of your Service Plan by logging into the SSO dashboard, selecting **Edit Plan**, and copying the Identity Zone ID from the URL.
<img src="images/sso_url.png">
The highlighted text in the example URL above is the Identity Zone ID of the Service Plan.

1. Execute the following command, replacing `YOUR-IDENTITY-ZONE-ID` with the Identity Zone ID of your Service Plan. You can also replace `service_plan_admin_client` with a different name for your client, and `secret` with a different client secret.
<pre class="terminal">
uaac curl -k -H"Accept:application/json" -H"Content-Type:application/json" -H"X-Identity-Zone-Id:YOUR-IDENTITY-ZONE-ID" -XPOST --data           '{"client_id":"service_plan_admin_client","client_secret":"secret","authorized_grant_types":["client_credentials"],"authorities":["scim.write","clients.admin","scim.read"]}' /oauth/clients</pre>

## <a id="add-users"></a>Adding Users

1. Target the [auth domain](index.html#create-plan) of your Single Sign-On Service Plan. This is the URL you provided when creating a Service Plan in the SSO dashboard.
<pre class="terminal">$ uaac target <span>https</span>://YOUR-AUTH-DOMAIN.login.YOUR-SYSTEM-DOMAIN</pre>
1. Fetch the token for your Service Plan admin client.
<pre class="terminal">$ uaac token client get service\_plan\_admin\_client
Client secret:
</pre>
1. When prompted with `Client secret`, enter the `secret` from the `uaac curl` command above.
1. Add new users.
<pre class="terminal">$ uaac user add --emails YOUR-USER<span>@</span>EMAIL.COM
User name:  </pre>
1. When prompted, enter a User name and Password.
1. (Optional) You can also create groups and add users to them.
<pre class="terminal">$ uaac group add
Group name: 
</pre>
When prompted, enter the name for the group you want to create.
To add a member to your new group, use the following command.
<pre class="terminal">$ uaac member add GROUP-NAME USER-NAME</pre>